Running SLURM prolog script on swarma1004
===============================================================================
Job started on Sat Nov 23 14:13:05 GMT 2024
Job ID          : 33308
Job name        : vitsmall_fp_224_moderateaug
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/distill_vitsmall_fp_moderateaug_224.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 16
Num of tasks    : 1
Hosts allocated : swarma1004
Job Output Follows ...
===============================================================================
torch.Size([3, 322, 322])
torch.Size([3, 322, 322])
torch.Size([3, 224, 224])
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Teacher and student have the same descriptor dimension. No adaptation needed.
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
VPRModel(
  (backbone): ViT(
    (to_patch_embedding): Sequential(
      (0): Rearrange('b c (h p1) (w p2) -> b (h w) (p1 p2 c)', p1=14, p2=14)
      (1): LayerNorm((588,), eps=1e-05, elementwise_affine=True)
      (2): Linear(in_features=588, out_features=384, bias=True)
      (3): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (transformer): Transformer(
      (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x ModuleList(
          (0): Attention(
            (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attend): Softmax(dim=-1)
            (dropout): Dropout(p=0.1, inplace=False)
            (to_qkv): Linear(in_features=384, out_features=1728, bias=False)
            (to_out): Sequential(
              (0): Linear(in_features=576, out_features=384, bias=True)
              (1): Dropout(p=0.1, inplace=False)
            )
          )
          (1): FeedForward(
            (net): Sequential(
              (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (1): Linear(in_features=384, out_features=1536, bias=True)
              (2): GELU(approximate='none')
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(in_features=1536, out_features=384, bias=True)
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
    )
  )
  (aggreagtion): SALAD(
    (token_features): Sequential(
      (0): Linear(in_features=384, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=256, bias=True)
    )
    (cluster_features): Sequential(
      (0): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1))
    )
    (score): Sequential(
      (0): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
    )
  )
)
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  |  8.3465 |
| Pitts30k_val_R5  | 21.5037 |
| Pitts30k_val_R10 | 31.5589 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 12.8812 |
| Pitts30k_val_R5  | 29.4953 |
| Pitts30k_val_R10 | 40.1682 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 19.8870 |
| Pitts30k_val_R5  | 40.4443 |
| Pitts30k_val_R10 | 52.9443 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 32.7681 |
| Pitts30k_val_R5  | 57.5841 |
| Pitts30k_val_R10 | 67.9811 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 42.9811 |
| Pitts30k_val_R5  | 65.9043 |
| Pitts30k_val_R10 | 75.1972 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 62.8680 |
| Pitts30k_val_R5  | 82.7024 |
| Pitts30k_val_R10 | 88.3544 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 71.3328 |
| Pitts30k_val_R5  | 88.6041 |
| Pitts30k_val_R10 | 92.4422 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 72.0426 |
| Pitts30k_val_R5  | 87.9732 |
| Pitts30k_val_R10 | 91.6667 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 72.0689 |
| Pitts30k_val_R5  | 87.9863 |
| Pitts30k_val_R10 | 92.1399 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 73.3833 |
| Pitts30k_val_R5  | 90.1288 |
| Pitts30k_val_R10 | 93.7171 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 75.2366 |
| Pitts30k_val_R5  | 90.2603 |
| Pitts30k_val_R10 | 93.4805 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 78.1283 |
| Pitts30k_val_R5  | 91.3512 |
| Pitts30k_val_R10 | 94.8738 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 80.5994 |
| Pitts30k_val_R5  | 93.1125 |
| Pitts30k_val_R10 | 95.7413 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 80.4022 |
| Pitts30k_val_R5  | 92.7445 |
| Pitts30k_val_R10 | 95.5967 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 81.2040 |
| Pitts30k_val_R5  | 93.3097 |
| Pitts30k_val_R10 | 95.7019 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 81.3354 |
| Pitts30k_val_R5  | 93.6251 |
| Pitts30k_val_R10 | 96.2014 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.6073 |
| Pitts30k_val_R5  | 94.9264 |
| Pitts30k_val_R10 | 96.7271 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 84.2797 |
| Pitts30k_val_R5  | 94.4664 |
| Pitts30k_val_R10 | 96.2671 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 83.8197 |
| Pitts30k_val_R5  | 94.2298 |
| Pitts30k_val_R10 | 96.2934 |
+------------------+---------+
Skipping corrupted image: 3057859
Skipping corrupted image: 1263776
Skipping corrupted image: 3283479
Skipping corrupted image: 1357413
Skipping corrupted image: 723652
Skipping corrupted image: 1661876
Skipping corrupted image: 2421385
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 995626
Skipping corrupted image: 3359030

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 83.9642 |
| Pitts30k_val_R5  | 94.2692 |
| Pitts30k_val_R10 | 96.3328 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 84.6609 |
| Pitts30k_val_R5  | 94.7029 |
| Pitts30k_val_R10 | 96.6877 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.7376 |
| Pitts30k_val_R5  | 95.5705 |
| Pitts30k_val_R10 | 97.2266 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.4890 |
| Pitts30k_val_R5  | 95.1104 |
| Pitts30k_val_R10 | 96.9111 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.3444 |
| Pitts30k_val_R5  | 95.0578 |
| Pitts30k_val_R10 | 96.8323 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.5547 |
| Pitts30k_val_R5  | 95.2156 |
| Pitts30k_val_R10 | 97.0294 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.5394 |
| Pitts30k_val_R5  | 95.9253 |
| Pitts30k_val_R10 | 97.2792 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.3423 |
| Pitts30k_val_R5  | 95.9385 |
| Pitts30k_val_R10 | 97.3712 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.0925 |
| Pitts30k_val_R5  | 95.6362 |
| Pitts30k_val_R10 | 97.1872 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.0137 |
| Pitts30k_val_R5  | 95.7545 |
| Pitts30k_val_R10 | 97.3055 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.5273 |
| Pitts30k_val_R5  | 95.5047 |
| Pitts30k_val_R10 | 97.3580 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.8155 |
| Pitts30k_val_R5  | 96.2277 |
| Pitts30k_val_R10 | 97.7261 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.3554 |
| Pitts30k_val_R5  | 95.8728 |
| Pitts30k_val_R10 | 97.6078 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.9064 |
| Pitts30k_val_R5  | 96.4774 |
| Pitts30k_val_R10 | 97.6735 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.9206 |
| Pitts30k_val_R5  | 96.3065 |
| Pitts30k_val_R10 | 97.6604 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.5131 |
| Pitts30k_val_R5  | 96.0436 |
| Pitts30k_val_R10 | 97.4501 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.4474 |
| Pitts30k_val_R5  | 96.0436 |
| Pitts30k_val_R10 | 97.5683 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6688 |
| Pitts30k_val_R5  | 96.9243 |
| Pitts30k_val_R10 | 98.0810 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.1420 |
| Pitts30k_val_R5  | 96.9243 |
| Pitts30k_val_R10 | 98.1598 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.9721 |
| Pitts30k_val_R5  | 96.3591 |
| Pitts30k_val_R10 | 97.6341 |
+------------------+---------+
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 3283479
Skipping corrupted image: 1357413
Skipping corrupted image: 2421385
Skipping corrupted image: 3057859
Skipping corrupted image: 1263776
Skipping corrupted image: 1661876
Skipping corrupted image: 723652

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.7224 |
| Pitts30k_val_R5  | 96.1356 |
| Pitts30k_val_R10 | 97.7918 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.6435 |
| Pitts30k_val_R5  | 96.2145 |
| Pitts30k_val_R10 | 97.7918 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.6172 |
| Pitts30k_val_R5  | 96.4248 |
| Pitts30k_val_R10 | 97.9758 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.0379 |
| Pitts30k_val_R5  | 96.5037 |
| Pitts30k_val_R10 | 98.0810 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.5910 |
| Pitts30k_val_R5  | 96.4248 |
| Pitts30k_val_R10 | 97.8444 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.5121 |
| Pitts30k_val_R5  | 96.3197 |
| Pitts30k_val_R10 | 97.7787 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6162 |
| Pitts30k_val_R5  | 96.7797 |
| Pitts30k_val_R10 | 98.1073 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6030 |
| Pitts30k_val_R5  | 96.8586 |
| Pitts30k_val_R10 | 98.1730 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.0379 |
| Pitts30k_val_R5  | 96.6351 |
| Pitts30k_val_R10 | 97.9758 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.0510 |
| Pitts30k_val_R5  | 96.7271 |
| Pitts30k_val_R10 | 97.9364 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.0379 |
| Pitts30k_val_R5  | 96.8060 |
| Pitts30k_val_R10 | 98.0678 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6819 |
| Pitts30k_val_R5  | 96.9243 |
| Pitts30k_val_R10 | 98.0810 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.4453 |
| Pitts30k_val_R5  | 96.7271 |
| Pitts30k_val_R10 | 98.1467 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.4585 |
| Pitts30k_val_R5  | 96.6746 |
| Pitts30k_val_R10 | 98.1467 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.3007 |
| Pitts30k_val_R5  | 96.8060 |
| Pitts30k_val_R10 | 98.1073 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.0510 |
| Pitts30k_val_R5  | 96.5300 |
| Pitts30k_val_R10 | 98.0152 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.0247 |
| Pitts30k_val_R5  | 96.6746 |
| Pitts30k_val_R10 | 98.1073 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.7608 |
| Pitts30k_val_R5  | 96.9900 |
| Pitts30k_val_R10 | 98.1730 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.8265 |
| Pitts30k_val_R5  | 97.0032 |
| Pitts30k_val_R10 | 98.2650 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.4979 |
| Pitts30k_val_R5  | 96.8586 |
| Pitts30k_val_R10 | 98.1335 |
+------------------+---------+
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 3283479
Skipping corrupted image: 1357413
Skipping corrupted image: 723652
Skipping corrupted image: 1661876
Skipping corrupted image: 1263776
Skipping corrupted image: 3057859
Skipping corrupted image: 2421385
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.5373 |
| Pitts30k_val_R5  | 96.8717 |
| Pitts30k_val_R10 | 98.1073 |
+------------------+---------+
[1;34mwandb[0m: ðŸš€ View run [33mbackbone[vit_small]_agg[salad]_teacher[dinosalad]_res[224x224]_aug[moderate]_decay[constant][0m at: [34mhttps://wandb.ai/vpr_minds/distill/runs/mjjgzegm[0m
==============================================================================
Running epilogue script on swarma1004.

Submit time  : 2024-11-23T14:13:04
Start time   : 2024-11-23T14:13:05
End time     : 2024-11-24T07:42:32
Elapsed time : 17:29:27 (Timelimit=2-11:00:00)

Job ID: 33308
Cluster: iridis_x
User/Group: oeg1n18/
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 3-04:44:58
CPU Efficiency: 27.42% of 11-15:51:12 core-walltime
Job Wall-clock time: 17:29:27
Memory Utilized: 164.14 GB
Memory Efficiency: 128.24% of 128.00 GB
