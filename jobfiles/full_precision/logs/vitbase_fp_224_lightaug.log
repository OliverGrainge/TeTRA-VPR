Running SLURM prolog script on swarma1002
===============================================================================
Job started on Fri Nov 22 08:47:53 GMT 2024
Job ID          : 32508
Job name        : vitbase_fp_224_lightaug
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/distill_vitbase_fp_lightaug_224.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 16
Num of tasks    : 1
Hosts allocated : swarma1002
Job Output Follows ...
===============================================================================
torch.Size([3, 322, 322])
torch.Size([3, 322, 322])
torch.Size([3, 224, 224])
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Teacher and student have the same descriptor dimension. No adaptation needed.
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
VPRModel(
  (backbone): ViT(
    (to_patch_embedding): Sequential(
      (0): Rearrange('b c (h p1) (w p2) -> b (h w) (p1 p2 c)', p1=14, p2=14)
      (1): LayerNorm((588,), eps=1e-05, elementwise_affine=True)
      (2): Linear(in_features=588, out_features=768, bias=True)
      (3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (transformer): Transformer(
      (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x ModuleList(
          (0): Attention(
            (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attend): Softmax(dim=-1)
            (dropout): Dropout(p=0.1, inplace=False)
            (to_qkv): Linear(in_features=768, out_features=2304, bias=False)
            (to_out): Sequential(
              (0): Linear(in_features=768, out_features=768, bias=True)
              (1): Dropout(p=0.1, inplace=False)
            )
          )
          (1): FeedForward(
            (net): Sequential(
              (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (1): Linear(in_features=768, out_features=3072, bias=True)
              (2): GELU(approximate='none')
              (3): Dropout(p=0.1, inplace=False)
              (4): Linear(in_features=3072, out_features=768, bias=True)
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
    )
  )
  (aggreagtion): SALAD(
    (token_features): Sequential(
      (0): Linear(in_features=768, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=256, bias=True)
    )
    (cluster_features): Sequential(
      (0): Conv2d(768, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1))
    )
    (score): Sequential(
      (0): Conv2d(768, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
    )
  )
)
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  |  9.8843 |
| Pitts30k_val_R5  | 23.7776 |
| Pitts30k_val_R10 | 34.8712 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 18.3491 |
| Pitts30k_val_R5  | 37.9206 |
| Pitts30k_val_R10 | 50.0131 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 37.2766 |
| Pitts30k_val_R5  | 60.9227 |
| Pitts30k_val_R10 | 71.5694 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 51.8796 |
| Pitts30k_val_R5  | 75.0000 |
| Pitts30k_val_R10 | 82.9259 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 61.3696 |
| Pitts30k_val_R5  | 82.3738 |
| Pitts30k_val_R10 | 88.5121 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 78.3517 |
| Pitts30k_val_R5  | 92.2056 |
| Pitts30k_val_R10 | 95.1761 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 81.8743 |
| Pitts30k_val_R5  | 93.9143 |
| Pitts30k_val_R10 | 95.9253 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 83.3202 |
| Pitts30k_val_R5  | 94.2035 |
| Pitts30k_val_R10 | 96.3854 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 81.1251 |
| Pitts30k_val_R5  | 93.1519 |
| Pitts30k_val_R10 | 95.3996 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 82.6893 |
| Pitts30k_val_R5  | 94.0063 |
| Pitts30k_val_R10 | 96.3065 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 84.5689 |
| Pitts30k_val_R5  | 94.9658 |
| Pitts30k_val_R10 | 96.7534 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.5810 |
| Pitts30k_val_R5  | 95.2944 |
| Pitts30k_val_R10 | 97.0820 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.5536 |
| Pitts30k_val_R5  | 95.7676 |
| Pitts30k_val_R10 | 97.3186 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.8691 |
| Pitts30k_val_R5  | 95.4259 |
| Pitts30k_val_R10 | 97.3449 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.9085 |
| Pitts30k_val_R5  | 96.1225 |
| Pitts30k_val_R10 | 97.3449 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 87.5000 |
| Pitts30k_val_R5  | 95.9648 |
| Pitts30k_val_R10 | 97.6209 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6425 |
| Pitts30k_val_R5  | 96.8980 |
| Pitts30k_val_R10 | 98.1204 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6556 |
| Pitts30k_val_R5  | 96.7797 |
| Pitts30k_val_R10 | 97.9758 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.8933 |
| Pitts30k_val_R5  | 96.7534 |
| Pitts30k_val_R10 | 98.0547 |
+------------------+---------+
Skipping corrupted image: 1263776
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 3283479
Skipping corrupted image: 1357413
Skipping corrupted image: 723652
Skipping corrupted image: 2421385
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 3057859
Skipping corrupted image: 1661876

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.8801 |
| Pitts30k_val_R5  | 96.6746 |
| Pitts30k_val_R10 | 98.0152 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.1956 |
| Pitts30k_val_R5  | 96.9637 |
| Pitts30k_val_R10 | 98.1993 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.9974 |
| Pitts30k_val_R5  | 97.0163 |
| Pitts30k_val_R10 | 98.2256 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.8265 |
| Pitts30k_val_R5  | 96.9506 |
| Pitts30k_val_R10 | 98.0810 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.8134 |
| Pitts30k_val_R5  | 97.2397 |
| Pitts30k_val_R10 | 98.5016 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6951 |
| Pitts30k_val_R5  | 96.9243 |
| Pitts30k_val_R10 | 98.2387 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.0489 |
| Pitts30k_val_R5  | 97.5815 |
| Pitts30k_val_R10 | 98.6725 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.8780 |
| Pitts30k_val_R5  | 97.5946 |
| Pitts30k_val_R10 | 98.4884 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.2986 |
| Pitts30k_val_R5  | 97.4632 |
| Pitts30k_val_R10 | 98.4490 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.7466 |
| Pitts30k_val_R5  | 97.3843 |
| Pitts30k_val_R10 | 98.4096 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.3128 |
| Pitts30k_val_R5  | 97.3449 |
| Pitts30k_val_R10 | 98.5147 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.3644 |
| Pitts30k_val_R5  | 97.8312 |
| Pitts30k_val_R10 | 98.8433 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.0095 |
| Pitts30k_val_R5  | 97.5683 |
| Pitts30k_val_R10 | 98.6330 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.0752 |
| Pitts30k_val_R5  | 97.5815 |
| Pitts30k_val_R10 | 98.5936 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.2066 |
| Pitts30k_val_R5  | 97.4895 |
| Pitts30k_val_R10 | 98.6330 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.4432 |
| Pitts30k_val_R5  | 97.6998 |
| Pitts30k_val_R10 | 98.7250 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.0489 |
| Pitts30k_val_R5  | 97.4369 |
| Pitts30k_val_R10 | 98.5147 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.0347 |
| Pitts30k_val_R5  | 98.0547 |
| Pitts30k_val_R10 | 98.8039 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.0084 |
| Pitts30k_val_R5  | 97.8312 |
| Pitts30k_val_R10 | 98.6593 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.7718 |
| Pitts30k_val_R5  | 97.6472 |
| Pitts30k_val_R10 | 98.6462 |
+------------------+---------+
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 3057859
Skipping corrupted image: 1661876
Skipping corrupted image: 3283479
Skipping corrupted image: 723652
Skipping corrupted image: 1357413
Skipping corrupted image: 1263776
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 2421385

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.7061 |
| Pitts30k_val_R5  | 97.6604 |
| Pitts30k_val_R10 | 98.8039 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.9164 |
| Pitts30k_val_R5  | 97.8312 |
| Pitts30k_val_R10 | 98.8170 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.0084 |
| Pitts30k_val_R5  | 97.9495 |
| Pitts30k_val_R10 | 98.8696 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.1004 |
| Pitts30k_val_R5  | 97.9495 |
| Pitts30k_val_R10 | 98.8696 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.0347 |
| Pitts30k_val_R5  | 97.9627 |
| Pitts30k_val_R10 | 98.7907 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.0741 |
| Pitts30k_val_R5  | 97.7524 |
| Pitts30k_val_R10 | 98.7645 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.3239 |
| Pitts30k_val_R5  | 98.0547 |
| Pitts30k_val_R10 | 98.8170 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.4553 |
| Pitts30k_val_R5  | 97.9495 |
| Pitts30k_val_R10 | 98.8302 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.2056 |
| Pitts30k_val_R5  | 97.9495 |
| Pitts30k_val_R10 | 98.8565 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.3370 |
| Pitts30k_val_R5  | 98.0152 |
| Pitts30k_val_R10 | 98.8828 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.3502 |
| Pitts30k_val_R5  | 97.8707 |
| Pitts30k_val_R10 | 98.8696 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.5079 |
| Pitts30k_val_R5  | 97.9101 |
| Pitts30k_val_R10 | 98.8696 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.5736 |
| Pitts30k_val_R5  | 97.9101 |
| Pitts30k_val_R10 | 98.9353 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.5736 |
| Pitts30k_val_R5  | 97.9627 |
| Pitts30k_val_R10 | 98.8828 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.6262 |
| Pitts30k_val_R5  | 97.9890 |
| Pitts30k_val_R10 | 98.8959 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.1924 |
| Pitts30k_val_R5  | 97.9758 |
| Pitts30k_val_R10 | 98.8696 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.2056 |
| Pitts30k_val_R5  | 97.9495 |
| Pitts30k_val_R10 | 98.8302 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.4685 |
| Pitts30k_val_R5  | 98.0284 |
| Pitts30k_val_R10 | 98.9353 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.5342 |
| Pitts30k_val_R5  | 98.0547 |
| Pitts30k_val_R10 | 98.9485 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.4422 |
| Pitts30k_val_R5  | 97.9232 |
| Pitts30k_val_R10 | 98.9748 |
+------------------+---------+
Skipping corrupted image: 1263776
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 2421385
Skipping corrupted image: 3057859
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 723652
Skipping corrupted image: 3283479
Skipping corrupted image: 1661876
Skipping corrupted image: 1357413

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 92.3896 |
| Pitts30k_val_R5  | 97.9232 |
| Pitts30k_val_R10 | 98.9616 |
+------------------+---------+
[1;34mwandb[0m: ðŸš€ View run [33mbackbone[vit_base]_agg[salad]_teacher[dinosalad]_res[224x224]_aug[light]_decay[constant][0m at: [34mhttps://wandb.ai/vpr_minds/distill/runs/r9pjadys[0m
==============================================================================
Running epilogue script on swarma1002.

Submit time  : 2024-11-22T08:47:52
Start time   : 2024-11-22T08:47:53
End time     : 2024-11-23T06:36:21
Elapsed time : 21:48:28 (Timelimit=2-11:00:00)

Job ID: 32508
Cluster: iridis_x
User/Group: oeg1n18/
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 3-01:23:15
CPU Efficiency: 21.03% of 14-12:55:28 core-walltime
Job Wall-clock time: 21:48:28
Memory Utilized: 143.48 GB
Memory Efficiency: 112.09% of 128.00 GB
