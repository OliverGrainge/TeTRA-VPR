Running SLURM prolog script on swarma1002
===============================================================================
Job started on Fri Nov 29 10:59:20 GMT 2024
Job ID          : 35578
Job name        : vitsmall_322_simoid
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/plrbitlinear/vitsmall_322_sigmoid.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 16
Num of tasks    : 1
Hosts allocated : swarma1002
Job Output Follows ...
===============================================================================
torch.Size([3, 322, 322])
torch.Size([3, 322, 322])
torch.Size([3, 322, 322])
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
Teacher and student have the same descriptor dimension. No adaptation needed.
========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================
VPRModel(
  (backbone): ViT(
    (to_patch_embedding): Sequential(
      (0): Rearrange('b c (h p1) (w p2) -> b (h w) (p1 p2 c)', p1=14, p2=14)
      (1): LayerNorm((588,), eps=1e-05, elementwise_affine=True)
      (2): Linear(in_features=588, out_features=384, bias=True)
      (3): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (transformer): Transformer(
      (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x ModuleList(
          (0): Attention(
            (norm): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attend): Softmax(dim=-1)
            (dropout): Dropout(p=0.1, inplace=False)
            (to_qkv): PLRBitLinear
            (to_out): Sequential(
              (0): PLRBitLinear
              (1): Dropout(p=0.1, inplace=False)
            )
          )
          (1): FeedForward(
            (net): Sequential(
              (0): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
              (1): PLRBitLinear
              (2): GELU(approximate='none')
              (3): Dropout(p=0.1, inplace=False)
              (4): PLRBitLinear
              (5): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
    )
  )
  (aggreagtion): SALAD(
    (token_features): Sequential(
      (0): Linear(in_features=384, out_features=512, bias=True)
      (1): ReLU()
      (2): Linear(in_features=512, out_features=256, bias=True)
    )
    (cluster_features): Sequential(
      (0): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1))
    )
    (score): Sequential(
      (0): Conv2d(384, 512, kernel_size=(1, 1), stride=(1, 1))
      (1): Dropout(p=0.3, inplace=False)
      (2): ReLU()
      (3): Conv2d(512, 64, kernel_size=(1, 1), stride=(1, 1))
    )
  )
)
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  |  9.4243 |
| Pitts30k_val_R5  | 23.8433 |
| Pitts30k_val_R10 | 34.8712 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 12.4869 |
| Pitts30k_val_R5  | 29.8764 |
| Pitts30k_val_R10 | 41.9953 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 16.0752 |
| Pitts30k_val_R5  | 35.0815 |
| Pitts30k_val_R10 | 46.7666 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 23.0021 |
| Pitts30k_val_R5  | 45.9779 |
| Pitts30k_val_R10 | 58.4253 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 39.4979 |
| Pitts30k_val_R5  | 63.8013 |
| Pitts30k_val_R10 | 73.7382 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 69.1115 |
| Pitts30k_val_R5  | 86.4879 |
| Pitts30k_val_R10 | 91.2329 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 76.6036 |
| Pitts30k_val_R5  | 91.1803 |
| Pitts30k_val_R10 | 94.4401 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 77.9443 |
| Pitts30k_val_R5  | 91.6009 |
| Pitts30k_val_R10 | 94.5978 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 77.4974 |
| Pitts30k_val_R5  | 91.8507 |
| Pitts30k_val_R10 | 94.7161 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 79.5478 |
| Pitts30k_val_R5  | 92.8759 |
| Pitts30k_val_R10 | 95.5573 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 83.9774 |
| Pitts30k_val_R5  | 94.2560 |
| Pitts30k_val_R10 | 95.9516 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.9621 |
| Pitts30k_val_R5  | 95.5047 |
| Pitts30k_val_R10 | 97.2135 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.3828 |
| Pitts30k_val_R5  | 95.5967 |
| Pitts30k_val_R10 | 97.2923 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.6719 |
| Pitts30k_val_R5  | 95.5836 |
| Pitts30k_val_R10 | 97.5026 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 85.7518 |
| Pitts30k_val_R5  | 95.0184 |
| Pitts30k_val_R10 | 96.9637 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 86.8691 |
| Pitts30k_val_R5  | 95.8202 |
| Pitts30k_val_R10 | 97.2792 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.1167 |
| Pitts30k_val_R5  | 96.7666 |
| Pitts30k_val_R10 | 98.1598 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.0762 |
| Pitts30k_val_R5  | 96.8323 |
| Pitts30k_val_R10 | 98.2518 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.3675 |
| Pitts30k_val_R5  | 96.6351 |
| Pitts30k_val_R10 | 98.1204 |
+------------------+---------+
Skipping corrupted image: 3283479
Skipping corrupted image: 2421385
Skipping corrupted image: 723652
Skipping corrupted image: 3057859
Skipping corrupted image: 1263776
Skipping corrupted image: 1357413
Skipping corrupted image: 1661876
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.3938 |
| Pitts30k_val_R5  | 96.2671 |
| Pitts30k_val_R10 | 97.7655 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.0915 |
| Pitts30k_val_R5  | 96.4117 |
| Pitts30k_val_R10 | 97.8970 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.7618 |
| Pitts30k_val_R5  | 96.6746 |
| Pitts30k_val_R10 | 98.1073 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.1036 |
| Pitts30k_val_R5  | 97.2529 |
| Pitts30k_val_R10 | 98.3307 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.8670 |
| Pitts30k_val_R5  | 97.0032 |
| Pitts30k_val_R10 | 98.2913 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 88.8275 |
| Pitts30k_val_R5  | 96.8323 |
| Pitts30k_val_R10 | 98.1861 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.1945 |
| Pitts30k_val_R5  | 97.1872 |
| Pitts30k_val_R10 | 98.3307 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.7203 |
| Pitts30k_val_R5  | 97.4501 |
| Pitts30k_val_R10 | 98.5279 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.2208 |
| Pitts30k_val_R5  | 97.2397 |
| Pitts30k_val_R10 | 98.4884 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.2350 |
| Pitts30k_val_R5  | 96.9637 |
| Pitts30k_val_R10 | 98.1204 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.1562 |
| Pitts30k_val_R5  | 96.9769 |
| Pitts30k_val_R10 | 98.2124 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.5231 |
| Pitts30k_val_R5  | 97.1215 |
| Pitts30k_val_R10 | 98.4490 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.9448 |
| Pitts30k_val_R5  | 97.3055 |
| Pitts30k_val_R10 | 98.4227 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.3523 |
| Pitts30k_val_R5  | 97.2660 |
| Pitts30k_val_R10 | 98.4490 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.8791 |
| Pitts30k_val_R5  | 97.1740 |
| Pitts30k_val_R10 | 98.3833 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.0499 |
| Pitts30k_val_R5  | 96.8454 |
| Pitts30k_val_R10 | 98.1598 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.4848 |
| Pitts30k_val_R5  | 96.7271 |
| Pitts30k_val_R10 | 98.0678 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.8780 |
| Pitts30k_val_R5  | 97.4763 |
| Pitts30k_val_R10 | 98.3964 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.4301 |
| Pitts30k_val_R5  | 97.6472 |
| Pitts30k_val_R10 | 98.5804 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.1420 |
| Pitts30k_val_R5  | 97.0952 |
| Pitts30k_val_R10 | 98.4359 |
+------------------+---------+
Skipping corrupted image: 1661876
Skipping corrupted image: 3283479
Skipping corrupted image: 1357413
Skipping corrupted image: 1263776
Skipping corrupted image: 723652
Skipping corrupted image: 3057859
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 3014996
Skipping corrupted image: 2421385
Skipping corrupted image: 2639231

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.8791 |
| Pitts30k_val_R5  | 96.4905 |
| Pitts30k_val_R10 | 97.7918 |
+------------------+---------+
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.2350 |
| Pitts30k_val_R5  | 97.0163 |
| Pitts30k_val_R10 | 98.2781 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.9842 |
| Pitts30k_val_R5  | 97.3580 |
| Pitts30k_val_R10 | 98.5673 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.2077 |
| Pitts30k_val_R5  | 97.2923 |
| Pitts30k_val_R10 | 98.4753 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.6819 |
| Pitts30k_val_R5  | 97.3712 |
| Pitts30k_val_R10 | 98.5147 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 89.1036 |
| Pitts30k_val_R5  | 96.7797 |
| Pitts30k_val_R10 | 98.1335 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.0620 |
| Pitts30k_val_R5  | 97.3843 |
| Pitts30k_val_R10 | 98.5147 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.0620 |
| Pitts30k_val_R5  | 97.5946 |
| Pitts30k_val_R10 | 98.5410 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.4443 |
| Pitts30k_val_R5  | 97.4369 |
| Pitts30k_val_R10 | 98.4753 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.3523 |
| Pitts30k_val_R5  | 97.5683 |
| Pitts30k_val_R10 | 98.5673 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.3785 |
| Pitts30k_val_R5  | 97.4763 |
| Pitts30k_val_R10 | 98.5147 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.4968 |
| Pitts30k_val_R5  | 97.2135 |
| Pitts30k_val_R10 | 98.4359 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.8386 |
| Pitts30k_val_R5  | 97.6735 |
| Pitts30k_val_R10 | 98.6725 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.4706 |
| Pitts30k_val_R5  | 97.4632 |
| Pitts30k_val_R10 | 98.4753 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.6283 |
| Pitts30k_val_R5  | 97.3055 |
| Pitts30k_val_R10 | 98.4621 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.3654 |
| Pitts30k_val_R5  | 97.4632 |
| Pitts30k_val_R10 | 98.5804 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.0631 |
| Pitts30k_val_R5  | 97.4763 |
| Pitts30k_val_R10 | 98.3438 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.5221 |
| Pitts30k_val_R5  | 97.7524 |
| Pitts30k_val_R10 | 98.7119 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 91.3118 |
| Pitts30k_val_R5  | 97.7129 |
| Pitts30k_val_R10 | 98.6462 |
+------------------+---------+

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.6151 |
| Pitts30k_val_R5  | 97.6341 |
| Pitts30k_val_R10 | 98.5542 |
+------------------+---------+
Skipping corrupted image: 2421385
Skipping corrupted image: 3283479
Skipping corrupted image: 2639231
Skipping corrupted image: 3014996
Skipping corrupted image: 1263776
Skipping corrupted image: 995626
Skipping corrupted image: 3359030
Skipping corrupted image: 1357413
Skipping corrupted image: 1661876
Skipping corrupted image: 723652
Skipping corrupted image: 3057859

Results for Pitts30k_val:
+------------------+---------+
|      Metric      |  Value  |
+------------------+---------+
| Pitts30k_val_R1  | 90.8123 |
| Pitts30k_val_R5  | 97.7918 |
| Pitts30k_val_R10 | 98.5410 |
+------------------+---------+
[1;34mwandb[0m: ðŸš€ View run [33mbackbone[vit_small_plrbitlinear]_agg[salad]_teacher[dinosalad]_res[322x322]_aug[severe]_decay[sigmoid][0m at: [34mhttps://wandb.ai/vpr_minds/distill/runs/v0e4uyzz[0m
==============================================================================
Running epilogue script on swarma1002.

Submit time  : 2024-11-28T11:43:02
Start time   : 2024-11-29T10:59:20
End time     : 2024-11-30T20:28:18
Elapsed time : 1-09:28:58 (Timelimit=2-11:00:00)

Job ID: 35578
Cluster: iridis_x
User/Group: oeg1n18/
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 4-12:02:39
CPU Efficiency: 20.17% of 22-07:43:28 core-walltime
Job Wall-clock time: 1-09:28:58
Memory Utilized: 163.47 GB
Memory Efficiency: 127.71% of 128.00 GB
