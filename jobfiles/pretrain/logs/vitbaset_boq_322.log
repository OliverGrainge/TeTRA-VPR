Running SLURM prolog script on swarmh1002
===============================================================================
Job started on Tue Jan 21 22:42:55 GMT 2025
Job ID          : 71666
Job name        : vitbaset_boq_322
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/pretrain/vitbaset_boq_322.slurm
Partition       : swarm_h100
Num hosts       : 1
Num cores       : 16
Num of tasks    : 1
Hosts allocated : swarmh1002
Job Output Follows ...
===============================================================================
VPRModel(
  (backbone): ViT(
    (to_patch_embedding): Sequential(
      (0): Rearrange('b c (h p1) (w p2) -> b (h w) (p1 p2 c)', p1=14, p2=14)
      (1): LayerNorm((588,), eps=1e-05, elementwise_affine=True)
      (2): Linear(in_features=588, out_features=768, bias=True)
      (3): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (transformer): Transformer(
      (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (layers): ModuleList(
        (0-11): 12 x ModuleList(
          (0): Attention(
            (lnorm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (lnorm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (to_qkv): BitLinear(in_features=768, out_features=2304, bias=False)
            (attend): Softmax(dim=-1)
            (dropout): Dropout(p=0.1, inplace=False)
            (to_out): Sequential(
              (0): BitLinear(in_features=768, out_features=768, bias=True)
              (1): Dropout(p=0.1, inplace=False)
            )
          )
          (1): FeedForward(
            (net): Sequential(
              (0): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
              (1): BitLinear(in_features=768, out_features=3072, bias=True)
              (2): GELU(approximate='none')
              (3): Dropout(p=0.1, inplace=False)
              (4): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
              (5): BitLinear(in_features=3072, out_features=768, bias=True)
              (6): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
    )
  )
  (aggreagtion): BoQ(
    (proj_c): Conv2d(768, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (norm_input): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (boqs): ModuleList(
      (0-3): 4 x BoQBlock(
        (encoder): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
          )
          (linear1): Linear(in_features=512, out_features=2048, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
          (linear2): Linear(in_features=2048, out_features=512, bias=True)
          (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.0, inplace=False)
          (dropout2): Dropout(p=0.0, inplace=False)
        )
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (norm_q): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (cross_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (norm_out): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
    (fc): Linear(in_features=256, out_features=24, bias=True)
  )
)
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092
Scanning directory: /scratch/oeg1n18/datasets/vpr/sf_xl/raw/train/panoramas
Found subdirectories. Scanning each:
  37.71: 228643 images
  37.76: 412361 images
  37.72: 235935 images
  37.78: 438066 images
  37.74: 311148 images
  37.70: 163665 images
  37.80: 188416 images
  37.77: 458764 images
  37.73: 347857 images
  37.79: 309385 images
  37.75: 335999 images
  37.81: 853 images
Total images found: 3431092
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250121_224308-drp8xw3q[0m
==============================================================================
Running epilogue script on swarmh1002.

Submit time  : 2025-01-21T22:42:52
Start time   : 2025-01-21T22:42:55
End time     : 2025-01-22T05:31:19
Elapsed time : 06:48:24 (Timelimit=2-11:00:00)

Job ID: 71666
Cluster: iridis_x
User/Group: oeg1n18/
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 16
CPU Utilized: 1-13:57:56
CPU Efficiency: 34.86% of 4-12:54:24 core-walltime
Job Wall-clock time: 06:48:24
Memory Utilized: 117.87 GB
Memory Efficiency: 184.17% of 64.00 GB
