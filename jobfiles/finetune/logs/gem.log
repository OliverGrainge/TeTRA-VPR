Running SLURM prolog script on swarma1004
===============================================================================
Job started on Wed Jan 15 23:04:58 GMT 2025
Job ID          : 69884
Job name        : gem
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/finetune/gem.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 12
Num of tasks    : 1
Hosts allocated : swarma1004
Job Output Follows ...
===============================================================================
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  76.4525   |
|          MSLS_val_fp32_R5          |  85.0054   |
|         MSLS_val_fp32_R10          |  87.4955   |
|     MSLS_val_fp32_search_time      | 20642.6942 |
|           MSLS_val_q_R1            |  74.7744   |
|           MSLS_val_q_R5            |  84.4551   |
|           MSLS_val_q_R10           |  86.9903   |
|       MSLS_val_q_search_time       | 1051.7468  |
|     Pittsburgh30k_val_fp32_R1      |  92.0478   |
|     Pittsburgh30k_val_fp32_R5      |  98.1730   |
|     Pittsburgh30k_val_fp32_R10     |  99.1325   |
| Pittsburgh30k_val_fp32_search_time | 7463.8000  |
|       Pittsburgh30k_val_q_R1       |  91.5484   |
|       Pittsburgh30k_val_q_R5       |  98.0678   |
|      Pittsburgh30k_val_q_R10       |  98.9879   |
|  Pittsburgh30k_val_q_search_time   |  256.8548  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250115_230512-66cp2g6k[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  69.6048   |
|          MSLS_val_fp32_R5          |  80.0884   |
|         MSLS_val_fp32_R10          |  83.6070   |
|     MSLS_val_fp32_search_time      | 20992.6131 |
|           MSLS_val_q_R1            |  67.8546   |
|           MSLS_val_q_R5            |  79.4388   |
|           MSLS_val_q_R10           |  82.9123   |
|       MSLS_val_q_search_time       |  802.9413  |
|     Pittsburgh30k_val_fp32_R1      |  88.6961   |
|     Pittsburgh30k_val_fp32_R5      |  96.8717   |
|     Pittsburgh30k_val_fp32_R10     |  98.2256   |
| Pittsburgh30k_val_fp32_search_time | 7779.2952  |
|       Pittsburgh30k_val_q_R1       |  88.0258   |
|       Pittsburgh30k_val_q_R5       |  96.4511   |
|      Pittsburgh30k_val_q_R10       |  98.1993   |
|  Pittsburgh30k_val_q_search_time   |  570.2181  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_002806-q6nl4rnj[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  72.3475   |
|          MSLS_val_fp32_R5          |  83.1018   |
|         MSLS_val_fp32_R10          |  85.8354   |
|     MSLS_val_fp32_search_time      | 20910.7115 |
|           MSLS_val_q_R1            |  71.4724   |
|           MSLS_val_q_R5            |  82.1003   |
|           MSLS_val_q_R10           |  85.1227   |
|       MSLS_val_q_search_time       |  710.1102  |
|     Pittsburgh30k_val_fp32_R1      |  89.9448   |
|     Pittsburgh30k_val_fp32_R5      |  97.2660   |
|     Pittsburgh30k_val_fp32_R10     |  98.5673   |
| Pittsburgh30k_val_fp32_search_time | 7593.7498  |
|       Pittsburgh30k_val_q_R1       |  89.0116   |
|       Pittsburgh30k_val_q_R5       |  96.9111   |
|      Pittsburgh30k_val_q_R10       |  98.2650   |
|  Pittsburgh30k_val_q_search_time   |  265.0335  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_010527-zgdizdcw[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  69.7041   |
|          MSLS_val_fp32_R5          |  80.3501   |
|         MSLS_val_fp32_R10          |  83.6250   |
|     MSLS_val_fp32_search_time      | 20869.2727 |
|           MSLS_val_q_R1            |  67.9989   |
|           MSLS_val_q_R5            |  79.3035   |
|           MSLS_val_q_R10           |  82.6958   |
|       MSLS_val_q_search_time       |  686.9907  |
|     Pittsburgh30k_val_fp32_R1      |  88.3807   |
|     Pittsburgh30k_val_fp32_R5      |  96.5825   |
|     Pittsburgh30k_val_fp32_R10     |  98.0284   |
| Pittsburgh30k_val_fp32_search_time | 7632.9150  |
|       Pittsburgh30k_val_q_R1       |  87.7234   |
|       Pittsburgh30k_val_q_R5       |  96.5300   |
|      Pittsburgh30k_val_q_R10       |  97.8970   |
|  Pittsburgh30k_val_q_search_time   |  259.6285  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_015447-6eca5w1n[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  75.9563   |
|          MSLS_val_fp32_R5          |  84.9693   |
|         MSLS_val_fp32_R10          |  87.2699   |
|     MSLS_val_fp32_search_time      | 10333.3650 |
|           MSLS_val_q_R1            |  73.3941   |
|           MSLS_val_q_R5            |  83.8055   |
|           MSLS_val_q_R10           |  86.3407   |
|       MSLS_val_q_search_time       |  414.2337  |
|     Pittsburgh30k_val_fp32_R1      |  92.1399   |
|     Pittsburgh30k_val_fp32_R5      |  98.0678   |
|     Pittsburgh30k_val_fp32_R10     |  98.9879   |
| Pittsburgh30k_val_fp32_search_time | 3774.6639  |
|       Pittsburgh30k_val_q_R1       |  90.5757   |
|       Pittsburgh30k_val_q_R5       |  97.7129   |
|      Pittsburgh30k_val_q_R10       |  98.8959   |
|  Pittsburgh30k_val_q_search_time   |  164.8171  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_021836-v7vrc26a[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  68.6756   |
|          MSLS_val_fp32_R5          |  79.9170   |
|         MSLS_val_fp32_R10          |  83.1018   |
|     MSLS_val_fp32_search_time      | 10544.5757 |
|           MSLS_val_q_R1            |  65.2743   |
|           MSLS_val_q_R5            |  78.4013   |
|           MSLS_val_q_R10           |  81.8838   |
|       MSLS_val_q_search_time       |  409.1580  |
|     Pittsburgh30k_val_fp32_R1      |  88.4332   |
|     Pittsburgh30k_val_fp32_R5      |  96.6220   |
|     Pittsburgh30k_val_fp32_R10     |  98.0810   |
| Pittsburgh30k_val_fp32_search_time | 3915.4243  |
|       Pittsburgh30k_val_q_R1       |  85.9753   |
|       Pittsburgh30k_val_q_R5       |  96.1488   |
|      Pittsburgh30k_val_q_R10       |  97.5552   |
|  Pittsburgh30k_val_q_search_time   |  157.0468  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_034114-pxtylx3m[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  72.0408   |
|          MSLS_val_fp32_R5          |  82.5604   |
|         MSLS_val_fp32_R10          |  85.2851   |
|     MSLS_val_fp32_search_time      | 10170.6500 |
|           MSLS_val_q_R1            |  69.9116   |
|           MSLS_val_q_R5            |  81.4417   |
|           MSLS_val_q_R10           |  84.4641   |
|       MSLS_val_q_search_time       |  412.4324  |
|     Pittsburgh30k_val_fp32_R1      |  89.4848   |
|     Pittsburgh30k_val_fp32_R5      |  97.1083   |
|     Pittsburgh30k_val_fp32_R10     |  98.4490   |
| Pittsburgh30k_val_fp32_search_time | 3715.7087  |
|       Pittsburgh30k_val_q_R1       |  88.5384   |
|       Pittsburgh30k_val_q_R5       |  96.6351   |
|      Pittsburgh30k_val_q_R10       |  98.0547   |
|  Pittsburgh30k_val_q_search_time   |  613.1787  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_041756-xjy72pmi[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  69.0094   |
|          MSLS_val_fp32_R5          |  79.8719   |
|         MSLS_val_fp32_R10          |  83.0206   |
|     MSLS_val_fp32_search_time      | 10331.2361 |
|           MSLS_val_q_R1            |  66.2126   |
|           MSLS_val_q_R5            |  78.5186   |
|           MSLS_val_q_R10           |  82.0823   |
|       MSLS_val_q_search_time       |  406.2710  |
|     Pittsburgh30k_val_fp32_R1      |  88.1046   |
|     Pittsburgh30k_val_fp32_R5      |  96.5957   |
|     Pittsburgh30k_val_fp32_R10     |  97.9495   |
| Pittsburgh30k_val_fp32_search_time | 3800.9696  |
|       Pittsburgh30k_val_q_R1       |  86.6062   |
|       Pittsburgh30k_val_q_R5       |  96.1619   |
|      Pittsburgh30k_val_q_R10       |  97.6472   |
|  Pittsburgh30k_val_q_search_time   |  157.5463  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_050702-0eeyfqrw[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+-----------+
|               Metric               |   Value   |
+------------------------------------+-----------+
|          MSLS_val_fp32_R1          |  75.3338  |
|          MSLS_val_fp32_R5          |  84.0491  |
|         MSLS_val_fp32_R10          |  86.7737  |
|     MSLS_val_fp32_search_time      | 5373.8732 |
|           MSLS_val_q_R1            |  69.9657  |
|           MSLS_val_q_R5            |  81.2703  |
|           MSLS_val_q_R10           |  84.2746  |
|       MSLS_val_q_search_time       |  440.4919 |
|     Pittsburgh30k_val_fp32_R1      |  91.2198  |
|     Pittsburgh30k_val_fp32_R5      |  98.0415  |
|     Pittsburgh30k_val_fp32_R10     |  99.0273  |
| Pittsburgh30k_val_fp32_search_time | 1954.9992 |
|       Pittsburgh30k_val_q_R1       |  88.0915  |
|       Pittsburgh30k_val_q_R5       |  96.9374  |
|      Pittsburgh30k_val_q_R10       |  98.5016  |
|  Pittsburgh30k_val_q_search_time   |  50.3981  |
+------------------------------------+-----------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_053014-xuf60gmw[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+-----------+
|               Metric               |   Value   |
+------------------------------------+-----------+
|          MSLS_val_fp32_R1          |  67.8095  |
|          MSLS_val_fp32_R5          |  79.2584  |
|         MSLS_val_fp32_R10          |  83.0296  |
|     MSLS_val_fp32_search_time      | 5417.3141 |
|           MSLS_val_q_R1            |  61.3677  |
|           MSLS_val_q_R5            |  75.9924  |
|           MSLS_val_q_R10           |  80.3049  |
|       MSLS_val_q_search_time       |  117.0921 |
|     Pittsburgh30k_val_fp32_R1      |  87.8417  |
|     Pittsburgh30k_val_fp32_R5      |  96.3328  |
|     Pittsburgh30k_val_fp32_R10     |  98.0678  |
| Pittsburgh30k_val_fp32_search_time | 1960.1052 |
|       Pittsburgh30k_val_q_R1       |  83.3070  |
|       Pittsburgh30k_val_q_R5       |  94.9921  |
|      Pittsburgh30k_val_q_R10       |  97.0032  |
|  Pittsburgh30k_val_q_search_time   |  51.7328  |
+------------------------------------+-----------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_065218-i4xop4hr[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])
