Running SLURM prolog script on swarma1004
===============================================================================
Job started on Wed Jan 15 23:02:57 GMT 2025
Job ID          : 69883
Job name        : boq
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/finetune/boq.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 12
Num of tasks    : 1
Hosts allocated : swarma1004
Job Output Follows ...
===============================================================================
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+-------------+
|               Metric               |    Value    |
+------------------------------------+-------------+
|          MSLS_val_fp32_R1          |   85.7723   |
|          MSLS_val_fp32_R5          |   92.1057   |
|         MSLS_val_fp32_R10          |   93.7387   |
|     MSLS_val_fp32_search_time      | 123140.5196 |
|           MSLS_val_q_R1            |   85.3392   |
|           MSLS_val_q_R5            |   91.8621   |
|           MSLS_val_q_R10           |   93.6395   |
|       MSLS_val_q_search_time       |  3803.9360  |
|     Pittsburgh30k_val_fp32_R1      |   94.3481   |
|     Pittsburgh30k_val_fp32_R5      |   98.7119   |
|     Pittsburgh30k_val_fp32_R10     |   99.4217   |
| Pittsburgh30k_val_fp32_search_time |  44848.4361 |
|       Pittsburgh30k_val_q_R1       |   94.2429   |
|       Pittsburgh30k_val_q_R5       |   98.7645   |
|      Pittsburgh30k_val_q_R10       |   99.3297   |
|  Pittsburgh30k_val_q_search_time   |  1295.9609  |
+------------------------------------+-------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250115_230315-ei3qsqve[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+-------------+
|               Metric               |    Value    |
+------------------------------------+-------------+
|          MSLS_val_fp32_R1          |   81.5770   |
|          MSLS_val_fp32_R5          |   88.9661   |
|         MSLS_val_fp32_R10          |   91.3208   |
|     MSLS_val_fp32_search_time      | 124144.1867 |
|           MSLS_val_q_R1            |   81.0628   |
|           MSLS_val_q_R5            |   89.0112   |
|           MSLS_val_q_R10           |   91.2667   |
|       MSLS_val_q_search_time       |  3773.5617  |
|     Pittsburgh30k_val_fp32_R1      |   93.2308   |
|     Pittsburgh30k_val_fp32_R5      |   98.4490   |
|     Pittsburgh30k_val_fp32_R10     |   99.1325   |
| Pittsburgh30k_val_fp32_search_time |  45370.1162 |
|       Pittsburgh30k_val_q_R1       |   93.2308   |
|       Pittsburgh30k_val_q_R5       |   98.4227   |
|      Pittsburgh30k_val_q_R10       |   99.1062   |
|  Pittsburgh30k_val_q_search_time   |  1293.4082  |
+------------------------------------+-------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_003744-24gteczp[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+-------------+
|               Metric               |    Value    |
+------------------------------------+-------------+
|          MSLS_val_fp32_R1          |   83.3454   |
|          MSLS_val_fp32_R5          |   90.5269   |
|         MSLS_val_fp32_R10          |   92.5117   |
|     MSLS_val_fp32_search_time      | 124437.4213 |
|           MSLS_val_q_R1            |   82.8852   |
|           MSLS_val_q_R5            |   90.2923   |
|           MSLS_val_q_R10           |   92.3674   |
|       MSLS_val_q_search_time       |  4054.6637  |
|     Pittsburgh30k_val_fp32_R1      |   93.4017   |
|     Pittsburgh30k_val_fp32_R5      |   98.6725   |
|     Pittsburgh30k_val_fp32_R10     |   99.3428   |
| Pittsburgh30k_val_fp32_search_time |  45005.4483 |
|       Pittsburgh30k_val_q_R1       |   93.0862   |
|       Pittsburgh30k_val_q_R5       |   98.4753   |
|      Pittsburgh30k_val_q_R10       |   99.2902   |
|  Pittsburgh30k_val_q_search_time   |  1294.6970  |
+------------------------------------+-------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_012310-xo0jmurt[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+-------------+
|               Metric               |    Value    |
+------------------------------------+-------------+
|          MSLS_val_fp32_R1          |   80.6297   |
|          MSLS_val_fp32_R5          |   88.5601   |
|         MSLS_val_fp32_R10          |   91.0231   |
|     MSLS_val_fp32_search_time      | 123439.1124 |
|           MSLS_val_q_R1            |   80.3591   |
|           MSLS_val_q_R5            |   88.6232   |
|           MSLS_val_q_R10           |   91.2396   |
|       MSLS_val_q_search_time       |  4446.9721  |
|     Pittsburgh30k_val_fp32_R1      |   92.8365   |
|     Pittsburgh30k_val_fp32_R5      |   98.1598   |
|     Pittsburgh30k_val_fp32_R10     |   98.9090   |
| Pittsburgh30k_val_fp32_search_time |  44917.5766 |
|       Pittsburgh30k_val_q_R1       |   92.6788   |
|       Pittsburgh30k_val_q_R5       |   98.0941   |
|      Pittsburgh30k_val_q_R10       |   98.8828   |
|  Pittsburgh30k_val_q_search_time   |  1296.7136  |
+------------------------------------+-------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_022424-o295p1kp[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  84.8520   |
|          MSLS_val_fp32_R5          |  91.7088   |
|         MSLS_val_fp32_R10          |  93.4771   |
|     MSLS_val_fp32_search_time      | 61917.9871 |
|           MSLS_val_q_R1            |  84.6355   |
|           MSLS_val_q_R5            |  91.4922   |
|           MSLS_val_q_R10           |  93.3057   |
|       MSLS_val_q_search_time       | 1829.3746  |
|     Pittsburgh30k_val_fp32_R1      |  94.4664   |
|     Pittsburgh30k_val_fp32_R5      |  98.9353   |
|     Pittsburgh30k_val_fp32_R10     |  99.4874   |
| Pittsburgh30k_val_fp32_search_time | 22516.0770 |
|       Pittsburgh30k_val_q_R1       |  94.3875   |
|       Pittsburgh30k_val_q_R5       |  98.8565   |
|      Pittsburgh30k_val_q_R10       |  99.3954   |
|  Pittsburgh30k_val_q_search_time   |  674.9766  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_025629-5ga1rafj[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  81.0447   |
|          MSLS_val_fp32_R5          |  88.9119   |
|         MSLS_val_fp32_R10          |  91.1674   |
|     MSLS_val_fp32_search_time      | 61829.2594 |
|           MSLS_val_q_R1            |  80.4583   |
|           MSLS_val_q_R5            |  88.8037   |
|           MSLS_val_q_R10           |  90.9690   |
|       MSLS_val_q_search_time       | 1939.1761  |
|     Pittsburgh30k_val_fp32_R1      |  92.6130   |
|     Pittsburgh30k_val_fp32_R5      |  98.3833   |
|     Pittsburgh30k_val_fp32_R10     |  99.0799   |
| Pittsburgh30k_val_fp32_search_time | 22429.2974 |
|       Pittsburgh30k_val_q_R1       |  92.4422   |
|       Pittsburgh30k_val_q_R5       |  98.1861   |
|      Pittsburgh30k_val_q_R10       |  99.0668   |
|  Pittsburgh30k_val_q_search_time   |  660.8255  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_042430-y9lu5d5o[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  82.9394   |
|          MSLS_val_fp32_R5          |  90.3104   |
|         MSLS_val_fp32_R10          |  92.2952   |
|     MSLS_val_fp32_search_time      | 61792.0127 |
|           MSLS_val_q_R1            |  82.5875   |
|           MSLS_val_q_R5            |  90.1750   |
|           MSLS_val_q_R10           |  92.1148   |
|       MSLS_val_q_search_time       | 1839.3710  |
|     Pittsburgh30k_val_fp32_R1      |  93.2308   |
|     Pittsburgh30k_val_fp32_R5      |  98.4621   |
|     Pittsburgh30k_val_fp32_R10     |  99.3165   |
| Pittsburgh30k_val_fp32_search_time | 22563.8297 |
|       Pittsburgh30k_val_q_R1       |  93.0731   |
|       Pittsburgh30k_val_q_R5       |  98.4621   |
|      Pittsburgh30k_val_q_R10       |  99.3428   |
|  Pittsburgh30k_val_q_search_time   |  667.0725  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_050516-m7bbp2tn[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  80.2689   |
|          MSLS_val_fp32_R5          |  88.1180   |
|         MSLS_val_fp32_R10          |  90.6261   |
|     MSLS_val_fp32_search_time      | 61712.7969 |
|           MSLS_val_q_R1            |  80.0433   |
|           MSLS_val_q_R5            |  87.8383   |
|           MSLS_val_q_R10           |  90.0848   |
|       MSLS_val_q_search_time       | 1824.5533  |
|     Pittsburgh30k_val_fp32_R1      |  92.6130   |
|     Pittsburgh30k_val_fp32_R5      |  98.0547   |
|     Pittsburgh30k_val_fp32_R10     |  98.8696   |
| Pittsburgh30k_val_fp32_search_time | 22509.0520 |
|       Pittsburgh30k_val_q_R1       |  92.0084   |
|       Pittsburgh30k_val_q_R5       |  97.9101   |
|      Pittsburgh30k_val_q_R10       |  98.8433   |
|  Pittsburgh30k_val_q_search_time   |  662.7502  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_055955-2spete0y[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  84.3649   |
|          MSLS_val_fp32_R5          |  91.0863   |
|         MSLS_val_fp32_R10          |  93.0711   |
|     MSLS_val_fp32_search_time      | 30766.8588 |
|           MSLS_val_q_R1            |  83.4266   |
|           MSLS_val_q_R5            |  90.7975   |
|           MSLS_val_q_R10           |  92.7824   |
|       MSLS_val_q_search_time       | 1002.8737  |
|     Pittsburgh30k_val_fp32_R1      |  93.9012   |
|     Pittsburgh30k_val_fp32_R5      |  98.6462   |
|     Pittsburgh30k_val_fp32_R10     |  99.2771   |
| Pittsburgh30k_val_fp32_search_time | 11383.8301 |
|       Pittsburgh30k_val_q_R1       |  93.2965   |
|       Pittsburgh30k_val_q_R5       |  98.6067   |
|      Pittsburgh30k_val_q_R10       |  99.2771   |
|  Pittsburgh30k_val_q_search_time   |  359.2913  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_062717-3305lpjh[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])
