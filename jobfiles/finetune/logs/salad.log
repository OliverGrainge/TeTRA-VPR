Running SLURM prolog script on swarma1002
===============================================================================
Job started on Wed Jan 15 23:08:58 GMT 2025
Job ID          : 69886
Job name        : salad
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/finetune/salad.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 12
Num of tasks    : 1
Hosts allocated : swarma1002
Job Output Follows ...
===============================================================================
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  85.7542   |
|          MSLS_val_fp32_R5          |  92.2591   |
|         MSLS_val_fp32_R10          |  94.0364   |
|     MSLS_val_fp32_search_time      | 86534.1120 |
|           MSLS_val_q_R1            |  85.2671   |
|           MSLS_val_q_R5            |  92.1057   |
|           MSLS_val_q_R10           |  93.8921   |
|       MSLS_val_q_search_time       | 2579.5529  |
|     Pittsburgh30k_val_fp32_R1      |  94.2035   |
|     Pittsburgh30k_val_fp32_R5      |  98.6725   |
|     Pittsburgh30k_val_fp32_R10     |  99.3165   |
| Pittsburgh30k_val_fp32_search_time | 31710.4647 |
|       Pittsburgh30k_val_q_R1       |  93.9537   |
|       Pittsburgh30k_val_q_R5       |  98.7119   |
|      Pittsburgh30k_val_q_R10       |  99.3954   |
|  Pittsburgh30k_val_q_search_time   |  905.2827  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250115_230916-mmzfaurd[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  80.8463   |
|          MSLS_val_fp32_R5          |  88.8307   |
|         MSLS_val_fp32_R10          |  91.4471   |
|     MSLS_val_fp32_search_time      | 85102.4463 |
|           MSLS_val_q_R1            |  80.4854   |
|           MSLS_val_q_R5            |  88.6954   |
|           MSLS_val_q_R10           |  91.2577   |
|       MSLS_val_q_search_time       | 2532.6288  |
|     Pittsburgh30k_val_fp32_R1      |  92.4159   |
|     Pittsburgh30k_val_fp32_R5      |  97.9890   |
|     Pittsburgh30k_val_fp32_R10     |  98.8039   |
| Pittsburgh30k_val_fp32_search_time | 31440.8674 |
|       Pittsburgh30k_val_q_R1       |  92.0478   |
|       Pittsburgh30k_val_q_R5       |  97.9890   |
|      Pittsburgh30k_val_q_R10       |  98.6593   |
|  Pittsburgh30k_val_q_search_time   |  904.9079  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_003827-f78bulgr[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  83.5078   |
|          MSLS_val_fp32_R5          |  90.8697   |
|         MSLS_val_fp32_R10          |  92.8726   |
|     MSLS_val_fp32_search_time      | 89639.8451 |
|           MSLS_val_q_R1            |  83.1198   |
|           MSLS_val_q_R5            |  90.8246   |
|           MSLS_val_q_R10           |  92.6561   |
|       MSLS_val_q_search_time       | 2585.1438  |
|     Pittsburgh30k_val_fp32_R1      |  92.8233   |
|     Pittsburgh30k_val_fp32_R5      |  98.6725   |
|     Pittsburgh30k_val_fp32_R10     |  99.3559   |
| Pittsburgh30k_val_fp32_search_time | 32754.7002 |
|       Pittsburgh30k_val_q_R1       |  92.9679   |
|       Pittsburgh30k_val_q_R5       |  98.6199   |
|      Pittsburgh30k_val_q_R10       |  99.3428   |
|  Pittsburgh30k_val_q_search_time   |  916.2524  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_011943-m63yn9dg[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  80.6839   |
|          MSLS_val_fp32_R5          |  89.2367   |
|         MSLS_val_fp32_R10          |  91.6637   |
|     MSLS_val_fp32_search_time      | 84372.2155 |
|           MSLS_val_q_R1            |  80.3861   |
|           MSLS_val_q_R5            |  89.2097   |
|           MSLS_val_q_R10           |  91.5825   |
|       MSLS_val_q_search_time       | 2527.6306  |
|     Pittsburgh30k_val_fp32_R1      |  92.2056   |
|     Pittsburgh30k_val_fp32_R5      |  98.0284   |
|     Pittsburgh30k_val_fp32_R10     |  98.9090   |
| Pittsburgh30k_val_fp32_search_time | 31125.0105 |
|       Pittsburgh30k_val_q_R1       |  91.9033   |
|       Pittsburgh30k_val_q_R5       |  97.8444   |
|      Pittsburgh30k_val_q_R10       |  98.8170   |
|  Pittsburgh30k_val_q_search_time   |  905.0560  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_021541-492odcsp[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  84.9603   |
|          MSLS_val_fp32_R5          |  91.7268   |
|         MSLS_val_fp32_R10          |  93.8650   |
|     MSLS_val_fp32_search_time      | 43619.0729 |
|           MSLS_val_q_R1            |  84.4190   |
|           MSLS_val_q_R5            |  91.5374   |
|           MSLS_val_q_R10           |  93.6485   |
|       MSLS_val_q_search_time       | 1386.0745  |
|     Pittsburgh30k_val_fp32_R1      |  93.8880   |
|     Pittsburgh30k_val_fp32_R5      |  98.7907   |
|     Pittsburgh30k_val_fp32_R10     |  99.3954   |
| Pittsburgh30k_val_fp32_search_time | 15914.4561 |
|       Pittsburgh30k_val_q_R1       |  93.6646   |
|       Pittsburgh30k_val_q_R5       |  98.5147   |
|      Pittsburgh30k_val_q_R10       |  99.2639   |
|  Pittsburgh30k_val_q_search_time   |  504.0672  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_024423-qassyaei[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  80.5485   |
|          MSLS_val_fp32_R5          |  88.5962   |
|         MSLS_val_fp32_R10          |  91.1404   |
|     MSLS_val_fp32_search_time      | 43561.7952 |
|           MSLS_val_q_R1            |  79.7726   |
|           MSLS_val_q_R5            |  88.3706   |
|           MSLS_val_q_R10           |  90.8156   |
|       MSLS_val_q_search_time       | 1406.4929  |
|     Pittsburgh30k_val_fp32_R1      |  92.5342   |
|     Pittsburgh30k_val_fp32_R5      |  98.1204   |
|     Pittsburgh30k_val_fp32_R10     |  99.0011   |
| Pittsburgh30k_val_fp32_search_time | 16568.8660 |
|       Pittsburgh30k_val_q_R1       |  91.9558   |
|       Pittsburgh30k_val_q_R5       |  97.9495   |
|      Pittsburgh30k_val_q_R10       |  98.8302   |
|  Pittsburgh30k_val_q_search_time   |  510.5879  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_040852-k20m5ize[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  82.9484   |
|          MSLS_val_fp32_R5          |  90.4186   |
|         MSLS_val_fp32_R10          |  92.3223   |
|     MSLS_val_fp32_search_time      | 43651.0787 |
|           MSLS_val_q_R1            |  82.3259   |
|           MSLS_val_q_R5            |  90.1840   |
|           MSLS_val_q_R10           |  92.1689   |
|       MSLS_val_q_search_time       | 1377.7549  |
|     Pittsburgh30k_val_fp32_R1      |  93.1388   |
|     Pittsburgh30k_val_fp32_R5      |  98.5016   |
|     Pittsburgh30k_val_fp32_R10     |  99.2245   |
| Pittsburgh30k_val_fp32_search_time | 16023.7703 |
|       Pittsburgh30k_val_q_R1       |  93.0862   |
|       Pittsburgh30k_val_q_R5       |  98.4227   |
|      Pittsburgh30k_val_q_R10       |  99.2639   |
|  Pittsburgh30k_val_q_search_time   |  519.8705  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_044759-d2yboy80[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  79.9531   |
|          MSLS_val_fp32_R5          |  88.8578   |
|         MSLS_val_fp32_R10          |  91.6005   |
|     MSLS_val_fp32_search_time      | 43524.6325 |
|           MSLS_val_q_R1            |  79.4118   |
|           MSLS_val_q_R5            |  88.4067   |
|           MSLS_val_q_R10           |  91.2035   |
|       MSLS_val_q_search_time       | 1377.1672  |
|     Pittsburgh30k_val_fp32_R1      |  91.7324   |
|     Pittsburgh30k_val_fp32_R5      |  97.8444   |
|     Pittsburgh30k_val_fp32_R10     |  98.7645   |
| Pittsburgh30k_val_fp32_search_time | 15945.6694 |
|       Pittsburgh30k_val_q_R1       |  91.5484   |
|       Pittsburgh30k_val_q_R5       |  97.7918   |
|      Pittsburgh30k_val_q_R10       |  98.8170   |
|  Pittsburgh30k_val_q_search_time   |  508.3261  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_053955-2qq3wfay[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  84.2927   |
|          MSLS_val_fp32_R5          |  91.6456   |
|         MSLS_val_fp32_R10          |  93.3418   |
|     MSLS_val_fp32_search_time      | 23229.9385 |
|           MSLS_val_q_R1            |  83.9228   |
|           MSLS_val_q_R5            |  91.3840   |
|           MSLS_val_q_R10           |  93.1523   |
|       MSLS_val_q_search_time       |  763.2048  |
|     Pittsburgh30k_val_fp32_R1      |  93.7697   |
|     Pittsburgh30k_val_fp32_R5      |  98.5936   |
|     Pittsburgh30k_val_fp32_R10     |  99.4217   |
| Pittsburgh30k_val_fp32_search_time | 8669.9390  |
|       Pittsburgh30k_val_q_R1       |  93.0994   |
|       Pittsburgh30k_val_q_R5       |  98.5147   |
|      Pittsburgh30k_val_q_R10       |  99.2508   |
|  Pittsburgh30k_val_q_search_time   |  288.5211  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_060538-e1rxvxjw[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])
