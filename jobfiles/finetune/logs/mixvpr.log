Running SLURM prolog script on swarma1002
===============================================================================
Job started on Wed Jan 15 23:04:58 GMT 2025
Job ID          : 69885
Job name        : mixvpr
WorkDir         : /iridisfs/home/oeg1n18/QuantPlaceFinder
Command         : /iridisfs/home/oeg1n18/QuantPlaceFinder/jobfiles/finetune/mixvpr.slurm
Partition       : swarm_a100
Num hosts       : 1
Num cores       : 12
Num of tasks    : 1
Hosts allocated : swarma1002
Job Output Follows ...
===============================================================================
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  77.4359   |
|          MSLS_val_fp32_R5          |  86.9993   |
|         MSLS_val_fp32_R10          |  89.6247   |
|     MSLS_val_fp32_search_time      | 41728.1353 |
|           MSLS_val_q_R1            |  73.1054   |
|           MSLS_val_q_R5            |  85.3663   |
|           MSLS_val_q_R10           |  88.6503   |
|       MSLS_val_q_search_time       | 1268.3465  |
|     Pittsburgh30k_val_fp32_R1      |  91.8113   |
|     Pittsburgh30k_val_fp32_R5      |  98.3307   |
|     Pittsburgh30k_val_fp32_R10     |  99.0931   |
| Pittsburgh30k_val_fp32_search_time | 14953.1291 |
|       Pittsburgh30k_val_q_R1       |  89.7213   |
|       Pittsburgh30k_val_q_R5       |  97.6866   |
|      Pittsburgh30k_val_q_R10       |  98.6593   |
|  Pittsburgh30k_val_q_search_time   |  455.9991  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250115_230515-n7sjv7fx[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  72.2302   |
|          MSLS_val_fp32_R5          |  82.5424   |
|         MSLS_val_fp32_R10          |  85.7452   |
|     MSLS_val_fp32_search_time      | 41360.6796 |
|           MSLS_val_q_R1            |  69.2169   |
|           MSLS_val_q_R5            |  80.7200   |
|           MSLS_val_q_R10           |  84.1664   |
|       MSLS_val_q_search_time       | 1246.3329  |
|     Pittsburgh30k_val_fp32_R1      |  90.3260   |
|     Pittsburgh30k_val_fp32_R5      |  97.6735   |
|     Pittsburgh30k_val_fp32_R10     |  98.6593   |
| Pittsburgh30k_val_fp32_search_time | 14981.4281 |
|       Pittsburgh30k_val_q_R1       |  89.6030   |
|       Pittsburgh30k_val_q_R5       |  97.4632   |
|      Pittsburgh30k_val_q_R10       |  98.5804   |
|  Pittsburgh30k_val_q_search_time   |  456.9144  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_003442-7b1kta14[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  73.3941   |
|          MSLS_val_fp32_R5          |  84.2746   |
|         MSLS_val_fp32_R10          |  87.2158   |
|     MSLS_val_fp32_search_time      | 42168.0663 |
|           MSLS_val_q_R1            |  70.9581   |
|           MSLS_val_q_R5            |  82.8131   |
|           MSLS_val_q_R10           |  86.1422   |
|       MSLS_val_q_search_time       | 1257.7515  |
|     Pittsburgh30k_val_fp32_R1      |  90.2471   |
|     Pittsburgh30k_val_fp32_R5      |  98.0021   |
|     Pittsburgh30k_val_fp32_R10     |  98.7907   |
| Pittsburgh30k_val_fp32_search_time | 15435.6239 |
|       Pittsburgh30k_val_q_R1       |  89.4322   |
|       Pittsburgh30k_val_q_R5       |  97.7261   |
|      Pittsburgh30k_val_q_R10       |  98.6856   |
|  Pittsburgh30k_val_q_search_time   |  465.6785  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_011358-va6l9nzt[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  71.4995   |
|          MSLS_val_fp32_R5          |  82.5514   |
|         MSLS_val_fp32_R10          |  85.5738   |
|     MSLS_val_fp32_search_time      | 42401.6299 |
|           MSLS_val_q_R1            |  70.0108   |
|           MSLS_val_q_R5            |  81.7124   |
|           MSLS_val_q_R10           |  85.0866   |
|       MSLS_val_q_search_time       | 1270.6151  |
|     Pittsburgh30k_val_fp32_R1      |  89.6293   |
|     Pittsburgh30k_val_fp32_R5      |  97.4632   |
|     Pittsburgh30k_val_fp32_R10     |  98.5147   |
| Pittsburgh30k_val_fp32_search_time | 15844.7397 |
|       Pittsburgh30k_val_q_R1       |  89.0116   |
|       Pittsburgh30k_val_q_R5       |  97.1346   |
|      Pittsburgh30k_val_q_R10       |  98.2650   |
|  Pittsburgh30k_val_q_search_time   |  466.0540  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_020727-1tgu2vhn[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  76.5518   |
|          MSLS_val_fp32_R5          |  86.5121   |
|         MSLS_val_fp32_R10          |  89.2818   |
|     MSLS_val_fp32_search_time      | 21093.2055 |
|           MSLS_val_q_R1            |  72.5550   |
|           MSLS_val_q_R5            |  84.7528   |
|           MSLS_val_q_R10           |  87.9737   |
|       MSLS_val_q_search_time       |  668.2491  |
|     Pittsburgh30k_val_fp32_R1      |  92.4027   |
|     Pittsburgh30k_val_fp32_R5      |  98.3044   |
|     Pittsburgh30k_val_fp32_R10     |  99.1062   |
| Pittsburgh30k_val_fp32_search_time | 7493.7594  |
|       Pittsburgh30k_val_q_R1       |  89.9448   |
|       Pittsburgh30k_val_q_R5       |  97.9364   |
|      Pittsburgh30k_val_q_R10       |  98.8170   |
|  Pittsburgh30k_val_q_search_time   |  260.5481  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_023303-12bh1gos[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  71.7250   |
|          MSLS_val_fp32_R5          |  82.4973   |
|         MSLS_val_fp32_R10          |  85.5106   |
|     MSLS_val_fp32_search_time      | 20693.3148 |
|           MSLS_val_q_R1            |  68.9101   |
|           MSLS_val_q_R5            |  81.1981   |
|           MSLS_val_q_R10           |  84.6806   |
|       MSLS_val_q_search_time       |  690.9487  |
|     Pittsburgh30k_val_fp32_R1      |  90.3260   |
|     Pittsburgh30k_val_fp32_R5      |  97.5683   |
|     Pittsburgh30k_val_fp32_R10     |  98.6725   |
| Pittsburgh30k_val_fp32_search_time | 7602.5705  |
|       Pittsburgh30k_val_q_R1       |  88.7093   |
|       Pittsburgh30k_val_q_R5       |  97.5026   |
|      Pittsburgh30k_val_q_R10       |  98.5542   |
|  Pittsburgh30k_val_q_search_time   |  265.8505  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_040121-gsgo30em[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  73.1054   |
|          MSLS_val_fp32_R5          |  83.9769   |
|         MSLS_val_fp32_R10          |  86.9271   |
|     MSLS_val_fp32_search_time      | 21212.4014 |
|           MSLS_val_q_R1            |  69.4875   |
|           MSLS_val_q_R5            |  81.9830   |
|           MSLS_val_q_R10           |  85.3212   |
|       MSLS_val_q_search_time       |  756.6378  |
|     Pittsburgh30k_val_fp32_R1      |  90.0499   |
|     Pittsburgh30k_val_fp32_R5      |  97.7918   |
|     Pittsburgh30k_val_fp32_R10     |  98.7250   |
| Pittsburgh30k_val_fp32_search_time | 7638.7389  |
|       Pittsburgh30k_val_q_R1       |  88.3807   |
|       Pittsburgh30k_val_q_R5       |  97.1740   |
|      Pittsburgh30k_val_q_R10       |  98.1861   |
|  Pittsburgh30k_val_q_search_time   |  256.5675  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_043933-j26kzgkd[0m
backbone.pos_embedding torch.Size([1, 257, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  70.9581   |
|          MSLS_val_fp32_R5          |  82.2086   |
|         MSLS_val_fp32_R10          |  85.2219   |
|     MSLS_val_fp32_search_time      | 20778.0597 |
|           MSLS_val_q_R1            |  67.0516   |
|           MSLS_val_q_R5            |  79.7907   |
|           MSLS_val_q_R10           |  83.7604   |
|       MSLS_val_q_search_time       |  688.9067  |
|     Pittsburgh30k_val_fp32_R1      |  89.1430   |
|     Pittsburgh30k_val_fp32_R5      |  97.2266   |
|     Pittsburgh30k_val_fp32_R10     |  98.4227   |
| Pittsburgh30k_val_fp32_search_time | 7861.1639  |
|       Pittsburgh30k_val_q_R1       |  87.3554   |
|       Pittsburgh30k_val_q_R5       |  96.9637   |
|      Pittsburgh30k_val_q_R10       |  98.2387   |
|  Pittsburgh30k_val_q_search_time   |  261.8930  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_053138-26i1fyxv[0m
backbone.pos_embedding torch.Size([1, 530, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  76.9668   |
|          MSLS_val_fp32_R5          |  86.0881   |
|         MSLS_val_fp32_R10          |  88.8759   |
|     MSLS_val_fp32_search_time      | 10448.9393 |
|           MSLS_val_q_R1            |  72.3114   |
|           MSLS_val_q_R5            |  84.0130   |
|           MSLS_val_q_R10           |  87.1978   |
|       MSLS_val_q_search_time       |  402.2646  |
|     Pittsburgh30k_val_fp32_R1      |  92.4422   |
|     Pittsburgh30k_val_fp32_R5      |  98.4884   |
|     Pittsburgh30k_val_fp32_R10     |  99.1719   |
| Pittsburgh30k_val_fp32_search_time | 3733.8700  |
|       Pittsburgh30k_val_q_R1       |  90.5363   |
|       Pittsburgh30k_val_q_R5       |  97.8707   |
|      Pittsburgh30k_val_q_R10       |  98.8302   |
|  Pittsburgh30k_val_q_search_time   |  156.7383  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_055612-5w95ht0j[0m
backbone.pos_embedding torch.Size([1, 257, 768])
backbone.cls_token torch.Size([1, 1, 768])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([768, 588])
backbone.to_patch_embedding.2.bias torch.Size([768])
backbone.to_patch_embedding.3.weight torch.Size([768])
backbone.to_patch_embedding.3.bias torch.Size([768])
backbone.transformer.norm.weight torch.Size([768])
backbone.transformer.norm.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([768])
backbone.transformer.layers.0.1.net.0.bias torch.Size([768])
backbone.transformer.layers.0.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.0.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.0.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.bias torch.Size([768])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([768])
backbone.transformer.layers.1.1.net.0.bias torch.Size([768])
backbone.transformer.layers.1.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.1.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.1.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.bias torch.Size([768])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([768])
backbone.transformer.layers.2.1.net.0.bias torch.Size([768])
backbone.transformer.layers.2.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.2.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.2.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.bias torch.Size([768])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([768])
backbone.transformer.layers.3.1.net.0.bias torch.Size([768])
backbone.transformer.layers.3.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.3.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.3.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.bias torch.Size([768])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([768])
backbone.transformer.layers.4.1.net.0.bias torch.Size([768])
backbone.transformer.layers.4.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.4.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.4.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.bias torch.Size([768])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([768])
backbone.transformer.layers.5.1.net.0.bias torch.Size([768])
backbone.transformer.layers.5.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.5.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.5.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.bias torch.Size([768])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([768])
backbone.transformer.layers.6.1.net.0.bias torch.Size([768])
backbone.transformer.layers.6.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.6.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.6.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.bias torch.Size([768])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([768])
backbone.transformer.layers.7.1.net.0.bias torch.Size([768])
backbone.transformer.layers.7.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.7.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.7.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.bias torch.Size([768])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([768])
backbone.transformer.layers.8.1.net.0.bias torch.Size([768])
backbone.transformer.layers.8.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.8.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.8.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.bias torch.Size([768])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([768])
backbone.transformer.layers.9.1.net.0.bias torch.Size([768])
backbone.transformer.layers.9.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.9.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.9.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.bias torch.Size([768])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([768])
backbone.transformer.layers.10.1.net.0.bias torch.Size([768])
backbone.transformer.layers.10.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.10.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.10.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.bias torch.Size([768])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([768])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([768])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([2304, 768])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([768])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([768, 768])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([768])
backbone.transformer.layers.11.1.net.0.bias torch.Size([768])
backbone.transformer.layers.11.1.net.1.weight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([3072, 768])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([3072])
backbone.transformer.layers.11.1.net.4.bias torch.Size([3072])
backbone.transformer.layers.11.1.net.5.weight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.bias torch.Size([768])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([768, 3072])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 768])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 768, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])

Results for Pitts30k:
+------------------------------------+------------+
|               Metric               |   Value    |
+------------------------------------+------------+
|          MSLS_val_fp32_R1          |  71.9325   |
|          MSLS_val_fp32_R5          |  82.2808   |
|         MSLS_val_fp32_R10          |  85.4294   |
|     MSLS_val_fp32_search_time      | 10379.0956 |
|           MSLS_val_q_R1            |  67.9809   |
|           MSLS_val_q_R5            |  80.3410   |
|           MSLS_val_q_R10           |  84.2025   |
|       MSLS_val_q_search_time       |  406.3694  |
|     Pittsburgh30k_val_fp32_R1      |  90.3391   |
|     Pittsburgh30k_val_fp32_R5      |  97.5421   |
|     Pittsburgh30k_val_fp32_R10     |  98.6199   |
| Pittsburgh30k_val_fp32_search_time | 3789.3343  |
|       Pittsburgh30k_val_q_R1       |  87.7497   |
|       Pittsburgh30k_val_q_R5       |  96.7534   |
|      Pittsburgh30k_val_q_R10       |  98.1993   |
|  Pittsburgh30k_val_q_search_time   |  156.0962  |
+------------------------------------+------------+
[1;34mwandb[0m:
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync ./wandb/offline-run-20250116_072350-enm7bczi[0m
backbone.pos_embedding torch.Size([1, 530, 384])
backbone.cls_token torch.Size([1, 1, 384])
backbone.to_patch_embedding.1.weight torch.Size([588])
backbone.to_patch_embedding.1.bias torch.Size([588])
backbone.to_patch_embedding.2.weight torch.Size([384, 588])
backbone.to_patch_embedding.2.bias torch.Size([384])
backbone.to_patch_embedding.3.weight torch.Size([384])
backbone.to_patch_embedding.3.bias torch.Size([384])
backbone.transformer.norm.weight torch.Size([384])
backbone.transformer.norm.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.0.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.0.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.0.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.0.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.0.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.0.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.0.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.0.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.0.1.net.0.weight torch.Size([384])
backbone.transformer.layers.0.1.net.0.bias torch.Size([384])
backbone.transformer.layers.0.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.0.1.net.1.scale torch.Size([])
backbone.transformer.layers.0.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.0.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.0.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.bias torch.Size([384])
backbone.transformer.layers.0.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.0.1.net.5.scale torch.Size([])
backbone.transformer.layers.1.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.1.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.1.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.1.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.1.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.1.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.1.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.1.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.1.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.1.1.net.0.weight torch.Size([384])
backbone.transformer.layers.1.1.net.0.bias torch.Size([384])
backbone.transformer.layers.1.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.1.1.net.1.scale torch.Size([])
backbone.transformer.layers.1.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.1.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.1.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.bias torch.Size([384])
backbone.transformer.layers.1.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.1.1.net.5.scale torch.Size([])
backbone.transformer.layers.2.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.2.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.2.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.2.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.2.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.2.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.2.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.2.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.2.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.2.1.net.0.weight torch.Size([384])
backbone.transformer.layers.2.1.net.0.bias torch.Size([384])
backbone.transformer.layers.2.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.2.1.net.1.scale torch.Size([])
backbone.transformer.layers.2.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.2.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.2.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.bias torch.Size([384])
backbone.transformer.layers.2.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.2.1.net.5.scale torch.Size([])
backbone.transformer.layers.3.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.3.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.3.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.3.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.3.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.3.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.3.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.3.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.3.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.3.1.net.0.weight torch.Size([384])
backbone.transformer.layers.3.1.net.0.bias torch.Size([384])
backbone.transformer.layers.3.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.3.1.net.1.scale torch.Size([])
backbone.transformer.layers.3.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.3.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.3.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.bias torch.Size([384])
backbone.transformer.layers.3.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.3.1.net.5.scale torch.Size([])
backbone.transformer.layers.4.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.4.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.4.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.4.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.4.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.4.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.4.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.4.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.4.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.4.1.net.0.weight torch.Size([384])
backbone.transformer.layers.4.1.net.0.bias torch.Size([384])
backbone.transformer.layers.4.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.4.1.net.1.scale torch.Size([])
backbone.transformer.layers.4.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.4.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.4.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.bias torch.Size([384])
backbone.transformer.layers.4.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.4.1.net.5.scale torch.Size([])
backbone.transformer.layers.5.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.5.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.5.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.5.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.5.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.5.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.5.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.5.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.5.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.5.1.net.0.weight torch.Size([384])
backbone.transformer.layers.5.1.net.0.bias torch.Size([384])
backbone.transformer.layers.5.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.5.1.net.1.scale torch.Size([])
backbone.transformer.layers.5.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.5.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.5.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.bias torch.Size([384])
backbone.transformer.layers.5.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.5.1.net.5.scale torch.Size([])
backbone.transformer.layers.6.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.6.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.6.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.6.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.6.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.6.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.6.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.6.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.6.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.6.1.net.0.weight torch.Size([384])
backbone.transformer.layers.6.1.net.0.bias torch.Size([384])
backbone.transformer.layers.6.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.6.1.net.1.scale torch.Size([])
backbone.transformer.layers.6.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.6.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.6.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.bias torch.Size([384])
backbone.transformer.layers.6.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.6.1.net.5.scale torch.Size([])
backbone.transformer.layers.7.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.7.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.7.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.7.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.7.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.7.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.7.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.7.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.7.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.7.1.net.0.weight torch.Size([384])
backbone.transformer.layers.7.1.net.0.bias torch.Size([384])
backbone.transformer.layers.7.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.7.1.net.1.scale torch.Size([])
backbone.transformer.layers.7.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.7.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.7.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.bias torch.Size([384])
backbone.transformer.layers.7.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.7.1.net.5.scale torch.Size([])
backbone.transformer.layers.8.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.8.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.8.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.8.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.8.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.8.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.8.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.8.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.8.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.8.1.net.0.weight torch.Size([384])
backbone.transformer.layers.8.1.net.0.bias torch.Size([384])
backbone.transformer.layers.8.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.8.1.net.1.scale torch.Size([])
backbone.transformer.layers.8.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.8.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.8.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.bias torch.Size([384])
backbone.transformer.layers.8.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.8.1.net.5.scale torch.Size([])
backbone.transformer.layers.9.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.9.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.9.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.9.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.9.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.9.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.9.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.9.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.9.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.9.1.net.0.weight torch.Size([384])
backbone.transformer.layers.9.1.net.0.bias torch.Size([384])
backbone.transformer.layers.9.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.9.1.net.1.scale torch.Size([])
backbone.transformer.layers.9.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.9.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.9.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.bias torch.Size([384])
backbone.transformer.layers.9.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.9.1.net.5.scale torch.Size([])
backbone.transformer.layers.10.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.10.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.10.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.10.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.10.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.10.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.10.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.10.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.10.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.10.1.net.0.weight torch.Size([384])
backbone.transformer.layers.10.1.net.0.bias torch.Size([384])
backbone.transformer.layers.10.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.10.1.net.1.scale torch.Size([])
backbone.transformer.layers.10.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.10.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.10.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.bias torch.Size([384])
backbone.transformer.layers.10.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.10.1.net.5.scale torch.Size([])
backbone.transformer.layers.11.0.lnorm1.weight torch.Size([384])
backbone.transformer.layers.11.0.lnorm1.bias torch.Size([384])
backbone.transformer.layers.11.0.lnorm2.weight torch.Size([588])
backbone.transformer.layers.11.0.lnorm2.bias torch.Size([588])
backbone.transformer.layers.11.0.to_qkv.weight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.qweight torch.Size([1764, 384])
backbone.transformer.layers.11.0.to_qkv.scale torch.Size([])
backbone.transformer.layers.11.0.to_out.0.weight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.bias torch.Size([384])
backbone.transformer.layers.11.0.to_out.0.qweight torch.Size([384, 588])
backbone.transformer.layers.11.0.to_out.0.scale torch.Size([])
backbone.transformer.layers.11.1.net.0.weight torch.Size([384])
backbone.transformer.layers.11.1.net.0.bias torch.Size([384])
backbone.transformer.layers.11.1.net.1.weight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.1.qweight torch.Size([1536, 384])
backbone.transformer.layers.11.1.net.1.scale torch.Size([])
backbone.transformer.layers.11.1.net.4.weight torch.Size([1536])
backbone.transformer.layers.11.1.net.4.bias torch.Size([1536])
backbone.transformer.layers.11.1.net.5.weight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.bias torch.Size([384])
backbone.transformer.layers.11.1.net.5.qweight torch.Size([384, 1536])
backbone.transformer.layers.11.1.net.5.scale torch.Size([])
aggreagtion.dust_bin torch.Size([])
aggreagtion.token_features.0.weight torch.Size([512, 384])
aggreagtion.token_features.0.bias torch.Size([512])
aggreagtion.token_features.2.weight torch.Size([256, 512])
aggreagtion.token_features.2.bias torch.Size([256])
aggreagtion.cluster_features.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.cluster_features.0.bias torch.Size([512])
aggreagtion.cluster_features.3.weight torch.Size([128, 512, 1, 1])
aggreagtion.cluster_features.3.bias torch.Size([128])
aggreagtion.score.0.weight torch.Size([512, 384, 1, 1])
aggreagtion.score.0.bias torch.Size([512])
aggreagtion.score.3.weight torch.Size([64, 512, 1, 1])
aggreagtion.score.3.bias torch.Size([64])
